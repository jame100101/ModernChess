
// 1.8 娓告垙妯″紡閫夋嫨灞忓箷 (PVP/PVE)
class GameModeSelectionScreen extends JPanel {
    private ChessGame mainFrame;

    public GameModeSelectionScreen(ChessGame frame) {
        this.mainFrame = frame;
        setLayout(new BorderLayout());
        setBackground(new Color(26, 28, 36));

        // Header
        JLabel header = new JLabel("SELECT GAME MODE", SwingConstants.CENTER);
        header.setFont(new Font("Segoe UI", Font.BOLD, 48));
        header.setForeground(new Color(220, 220, 220));
        header.setBorder(BorderFactory.createEmptyBorder(60, 0, 40, 0));
        add(header, BorderLayout.NORTH);

        // Center Container
        JPanel centerWrapper = new JPanel(new GridBagLayout());
        centerWrapper.setOpaque(false);
        
        JPanel cardsPanel = new JPanel(new GridLayout(1, 2, 30, 0)); // 2 columns
        cardsPanel.setOpaque(false);

        // Options
        String[][] options = {
            {"PLAYER vs PLAYER", "Local multiplayer\nPlay with a friend"},
            {"PLAYER vs AI", "Challenge the engine\nSelect difficulty next"}
        };

        for (int i = 0; i < options.length; i++) {
            String title = options[i][0];
            String desc = options[i][1];
            boolean isAI = (i == 1);

            JButton btn = new JButton();
            btn.setFocusPainted(false);
            btn.setContentAreaFilled(false);
            btn.setOpaque(true);
            btn.setPreferredSize(new Dimension(300, 400));
            btn.setCursor(new Cursor(Cursor.HAND_CURSOR));

            // HTML Styling
            StringBuilder html = new StringBuilder("<html><center>");
            html.append("<div style='color:#FFFFFF; font-weight:bold; font-size:24px;'>").append(title).append("</div>");
            html.append("<br><div style='color:#AAAAAA; font-size:16px;'>").append(desc.replace("\n", "<br>")).append("</div>");
            html.append("</center></html>");
            btn.setText(html.toString());

            Color normalBg = new Color(45, 48, 55);
            Color hoverBg = new Color(55, 58, 65);
            Color borderColor = new Color(80, 83, 95);
            
            btn.setBackground(normalBg);
            btn.setBorder(BorderFactory.createCompoundBorder(
                BorderFactory.createLineBorder(borderColor, 1),
                BorderFactory.createEmptyBorder(20, 20, 20, 20)
            ));

            // Hover Effect
            btn.addMouseListener(new MouseAdapter() {
                public void mouseEntered(MouseEvent e) {
                    btn.setBackground(hoverBg);
                    btn.setBorder(BorderFactory.createCompoundBorder(
                        BorderFactory.createLineBorder(new Color(100, 100, 120), 2),
                        BorderFactory.createEmptyBorder(19, 19, 19, 19)
                    ));
                }
                public void mouseExited(MouseEvent e) {
                    btn.setBackground(normalBg);
                    btn.setBorder(BorderFactory.createCompoundBorder(
                        BorderFactory.createLineBorder(borderColor, 1),
                        BorderFactory.createEmptyBorder(20, 20, 20, 20)
                    ));
                }
            });

            btn.addActionListener(e -> {
                if (isAI) {
                    // Go to difficulty selection (set amusing mode = true)
                    mainFrame.showDifficultySelection(true);
                } else {
                    // Start PVP immediately
                    mainFrame.startAmusementGame(false, 0);
                }
            });
            
            cardsPanel.add(btn);
        }
        
        centerWrapper.add(cardsPanel);
        add(centerWrapper, BorderLayout.CENTER);

        // Bottom - Back Button
        JPanel bottomPanel = new JPanel(new FlowLayout(FlowLayout.CENTER));
        bottomPanel.setOpaque(false);
        bottomPanel.setBorder(BorderFactory.createEmptyBorder(20, 0, 40, 0));
        
        JButton backBtn = new JButton("Back to Menu");
        backBtn.setFont(new Font("Segoe UI", Font.PLAIN, 16));
        backBtn.setForeground(new Color(150, 150, 150));
        backBtn.setContentAreaFilled(false);
        backBtn.setBorderPainted(false);
        backBtn.setFocusPainted(false);
        backBtn.setCursor(new Cursor(Cursor.HAND_CURSOR));
        backBtn.addMouseListener(new MouseAdapter() {
            public void mouseEntered(MouseEvent e) { backBtn.setForeground(Color.WHITE); }
            public void mouseExited(MouseEvent e) { backBtn.setForeground(new Color(150, 150, 150)); }
        });
        backBtn.addActionListener(e -> mainFrame.showMenu());
        
        bottomPanel.add(backBtn);
        add(bottomPanel, BorderLayout.SOUTH);
    }
    
    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        Graphics2D g2 = (Graphics2D) g;
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        GradientPaint gradient = new GradientPaint(
            0, 0, new Color(20, 22, 30),
            0, getHeight(), new Color(30, 32, 42)
        );
        g2.setPaint(gradient);
        g2.fillRect(0, 0, getWidth(), getHeight());
    }
}
